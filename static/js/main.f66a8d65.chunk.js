(this.webpackJsonpwhatsappclone=this.webpackJsonpwhatsappclone||[]).push([[0],{60:function(e,t,a){},61:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){},77:function(e,t,a){"use strict";a.r(t);var c=a(10),n=a.n(c),s=a(34),r=a.n(s),i=a(0),o=a.n(i),d=a(1),l=a(13),u=(a(60),a(61),a(7)),j=function(e){var t=e.onClick,a=e.active,n=e.data,s=Object(c.useState)(""),r=Object(l.a)(s,2),i=r[0],o=r[1];return Object(c.useEffect)((function(){if(n.lastMessageDate>0){var e=new Date(1e3*n.lastMessageDate.seconds),t=e.getHours(),a=e.getMinutes();a=a<10?"0"+a:a,o("".concat(t=t<10?"0"+t:t,":").concat(a))}}),[n]),Object(u.jsxs)("div",{className:"chatListItem ".concat(a?"active":""),onClick:t,children:[Object(u.jsx)("img",{className:"chatListItem-avatar",src:n.image,alt:""}),Object(u.jsxs)("div",{className:"chatListItem-lines",children:[Object(u.jsxs)("div",{className:"chatListItem-line",children:[Object(u.jsx)("div",{className:"chatListItem-name",children:n.title}),Object(u.jsx)("div",{className:"chatListItem-date",children:i})]}),Object(u.jsx)("div",{className:"chatListItem-line",children:Object(u.jsx)("div",{className:"chatListItem-lastMsg",children:Object(u.jsx)("p",{children:n.lastMessage})})})]})]})},h=(a(63),a.p+"static/media/Intro.5690d473.jpg"),b=function(){return Object(u.jsxs)("div",{className:"chatIntro",children:[Object(u.jsx)("img",{src:h,alt:""}),Object(u.jsx)("h1",{children:"Mantenha seu celular conectado"}),Object(u.jsx)("h2",{children:"O Whatsapp conecta ao seu telefone para sincronizar suas mensagens. Para reduzir o uso de dados, conecte seu telefone a uma rede Wi-Fi. "})]})},f=(a(64),function(e){var t=e.data,a=e.user,n=Object(c.useState)(""),s=Object(l.a)(n,2),r=s[0],i=s[1];return Object(c.useEffect)((function(){if(t.date>0){var e=new Date(1e3*t.date.seconds),a=e.getHours(),c=e.getMinutes();c=c<10?"0"+c:c,i("".concat(a=a<10?"0"+a:a,":").concat(c))}}),[t]),Object(u.jsx)("div",{className:"messageLine",style:{justifyContent:a.id===t.author?"flex-end":"flex-start"},children:Object(u.jsxs)("div",{className:"messageItem",style:{backgroundColor:a.id===t.author?"#DCF8C6":"#FFF"},children:[Object(u.jsx)("div",{className:"messageText",children:t.body}),Object(u.jsx)("div",{className:"messageDate",children:r})]})})}),m=(a(65),a(16)),v=a(30),O=(a(66),a(78),v.a.initializeApp({apiKey:"AIzaSyBh9NvYM203CNeT6dIGe4Ri6TimDM31RwU",authDomain:"whatsappclone-fbb06.firebaseapp.com",projectId:"whatsappclone-fbb06",storageBucket:"whatsappclone-fbb06.appspot.com",messagingSenderId:"149597100740",appId:"1:149597100740:web:d7ee77ecdab4ae92f38791",measurementId:"G-10R6Z98SKY"})),p=O.firestore(),x={fbPopup:function(){var e=Object(d.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new v.a.auth.FacebookAuthProvider,e.next=3,O.auth().signInWithPopup(t);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),addUser:function(){var e=Object(d.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.collection("users").doc(t.id).set({name:t.name,avatar:t.avatar},{merge:!0});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getContactList:function(){var e=Object(d.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.next=3,p.collection("users").get();case 3:return e.sent.forEach((function(e){var c=e.data();e.id!==t&&a.push({id:e.id,name:c.name,avatar:c.avatar})})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addNewChat:function(){var e=Object(d.a)(o.a.mark((function e(t,a){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.collection("chats").add({messages:[],users:[t.id,a.id]});case 2:c=e.sent,p.collection("users").doc(t.id).update({chats:v.a.firestore.FieldValue.arrayUnion({chatId:c.id,title:a.name,image:a.avatar,with:a.id})}),p.collection("users").doc(a.id).update({chats:v.a.firestore.FieldValue.arrayUnion({chatId:c.id,title:t.name,image:t.avatar,with:t.id})});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),onChatList:function(e,t){return p.collection("users").doc(e).onSnapshot((function(e){if(e.exists){var a=e.data();if(a.chats){var c=Object(m.a)(a.chats);c.sort((function(e,t){return void 0===e.lastMessageDate||void 0===t.lastMessageDate?-1:e.lastMessageDate.seconds<t.lastMessageDate.seconds?1:-1})),t(c)}}}))},onChatContent:function(e,t,a){return p.collection("chats").doc(e).onSnapshot((function(e){if(e.exists){var c=e.data();t(c.messages),a(c.users)}}))},sendMessage:function(){var e=Object(d.a)(o.a.mark((function e(t,a,c,n,s){var r,i,d,l,u,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Date,p.collection("chats").doc(t.chatId).update({messages:v.a.firestore.FieldValue.arrayUnion({type:c,author:a,body:n,date:r})}),e.t0=o.a.keys(s);case 3:if((e.t1=e.t0()).done){e.next=16;break}return i=e.t1.value,e.next=7,p.collection("users").doc(s[i]).get();case 7:if(d=e.sent,!(l=d.data()).chats){e.next=14;break}for(j in u=Object(m.a)(l.chats))u[j].chatId===t.chatId&&(u[j].lastMessage=n,u[j].lastMessageDate=r);return e.next=14,p.collection("users").doc(s[i]).update({chats:u});case 14:e.next=3;break;case 16:case"end":return e.stop()}}),e)})));return function(t,a,c,n,s){return e.apply(this,arguments)}}()},w=a(43),N=a.n(w),g=a(39),y=a.n(g),C=a(47),k=a.n(C),I=a(40),S=a.n(I),W=a(46),M=a.n(W),D=a(45),F=a.n(D),L=a(48),E=a.n(L),R=a(49),U=a.n(R),P=function(e){var t=e.user,a=e.data,n=Object(c.useRef)(),s=null,r=window.SpeechRecognition||window.webkitSpeechRecognition;void 0!==r&&(s=new r);var i=Object(c.useState)(!1),o=Object(l.a)(i,2),d=o[0],j=o[1],h=Object(c.useState)(""),b=Object(l.a)(h,2),m=b[0],v=b[1],O=Object(c.useState)(!1),p=Object(l.a)(O,2),w=p[0],g=p[1],C=Object(c.useState)([]),I=Object(l.a)(C,2),W=I[0],D=I[1],L=Object(c.useState)([]),R=Object(l.a)(L,2),P=R[0],z=R[1];Object(c.useEffect)((function(){return D([]),x.onChatContent(a.chatId,D,z)}),[a.chatId]),Object(c.useEffect)((function(){n.current.scrollHeight>n.current.offsetHeight&&(n.current.scrollTop=n.current.scrollHeight-n.current.offsetHeight)}),[W]);var A=function(){""!==m&&(x.sendMessage(a,t.id,"text",m,P),v(""),j(!1))};return Object(u.jsxs)("div",{className:"chatWindow",children:[Object(u.jsxs)("div",{className:"chatWindow-header",children:[Object(u.jsxs)("div",{className:"chatWindow-headerInfo",children:[Object(u.jsx)("img",{className:"chatWindow-avatar",src:a.image,alt:""}),Object(u.jsx)("div",{className:"chatWindow-name",children:a.title})]}),Object(u.jsxs)("div",{className:"chatWindow-headerButtons",children:[Object(u.jsx)("div",{className:"chatWindow-btn",children:Object(u.jsx)(y.a,{style:{color:"#919191"}})}),Object(u.jsx)("div",{className:"chatWindow-btn",children:Object(u.jsx)(S.a,{style:{color:"#919191"}})})]})]}),Object(u.jsx)("div",{ref:n,className:"chatWindow-body",children:W.map((function(e,a){return Object(u.jsx)(f,{user:t,data:e},a)}))}),Object(u.jsx)("div",{className:"chatWindow-emojiArea",style:{height:d?"200px":"0px"},children:Object(u.jsx)(N.a,{pickerStyle:{width:"auto"},disableSkinTonePicker:!0,disableSearchBar:!0,onEmojiClick:function(e,t){v(m+t.emoji)}})}),Object(u.jsxs)("div",{className:"chatWindow-footer",children:[Object(u.jsxs)("div",{className:"chatWindow-pre",children:[Object(u.jsx)("div",{className:"chatWindow-btn",style:{width:d?"40px":"0px"},children:Object(u.jsx)(F.a,{style:{color:"#919191"},onClick:function(){j(!1)}})}),Object(u.jsx)("div",{className:"chatWindow-btn",onClick:function(){j(!0)},children:Object(u.jsx)(M.a,{style:{color:d?"#009688":"#919191"}})}),Object(u.jsx)("div",{className:"chatWindow-btn",children:Object(u.jsx)(k.a,{style:{color:"#919191"}})})]}),Object(u.jsx)("div",{className:"chatWindow-inputArea",children:Object(u.jsx)("input",{value:m,onChange:function(e){return v(e.target.value)},onKeyUp:function(e){13==e.keyCode&&A()},type:"text",className:"chatWindow-input",placeholder:"Digite uma mensagem"})}),Object(u.jsx)("div",{className:"chatWindow-pos",children:m?Object(u.jsx)("div",{onClick:A,className:"chatWindow-btn",children:Object(u.jsx)(E.a,{style:{color:"#919191"}})}):Object(u.jsx)("div",{onClick:function(){null!==s&&(s.onstart=function(){g(!0)},s.onend=function(){g(!1)},s.onresult=function(e){v(e.results[0][0].transcript)},s.start())},className:"chatWindow-btn",children:Object(u.jsx)(U.a,{style:{color:w?"#126ECE":"#919191"}})})})]})]})},z=(a(74),a(50)),A=a.n(z),B=function(e){var t=e.user,a=(e.chatlist,e.show),n=e.setShow,s=Object(c.useState)([]),r=Object(l.a)(s,2),i=r[0],j=r[1];Object(c.useEffect)((function(){var e=function(){var e=Object(d.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t){e.next=5;break}return e.next=3,x.getContactList(t.id);case 3:a=e.sent,j(a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]);var h=function(){n(!1)},b=function(){var e=Object(d.a)(o.a.mark((function e(a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.addNewChat(t,a);case 2:h();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{className:"newChat",style:{left:a?0:-415},children:[Object(u.jsxs)("div",{className:"newChat-head",children:[Object(u.jsx)("div",{onClick:h,className:"newChat-backButton",children:Object(u.jsx)(A.a,{style:{color:"#FFFFFF"}})}),Object(u.jsx)("div",{className:"newChat-headTitle",children:"Nova Conversa"})]}),Object(u.jsx)("div",{className:"newChat-list",children:i.map((function(e,t){return Object(u.jsxs)("div",{onClick:function(){return b(e)},className:"newChat-item",children:[Object(u.jsx)("img",{className:"newChat-itemAvatar",src:e.avatar,alt:""}),Object(u.jsx)("div",{className:"newChat-itemName",children:e.name})]},t)}))})]})},H=(a(75),a(51)),T=a.n(H),K=function(e){var t=e.onReceive,a=function(){var e=Object(d.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.fbPopup();case 2:(a=e.sent)?t(a.user):alert("Erro!");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(u.jsx)("div",{className:"login",children:Object(u.jsx)(T.a,{style:{fontSize:"3em"},className:"fbIcon",onClick:a})})},V=a(52),G=a.n(V),J=a(53),Y=a.n(J);var q=function(){var e=Object(c.useState)([]),t=Object(l.a)(e,2),a=t[0],n=t[1],s=Object(c.useState)({}),r=Object(l.a)(s,2),i=r[0],h=r[1],f=Object(c.useState)(null),m=Object(l.a)(f,2),v=m[0],O=m[1],p=Object(c.useState)(!1),w=Object(l.a)(p,2),N=w[0],g=w[1];Object(c.useEffect)((function(){if(null!==v)return x.onChatList(v.id,n)}),[v]);var C=function(){var e=Object(d.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t.uid,name:t.displayName,avatar:t.photoURL},e.next=3,x.addUser(a);case 3:O(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return null===v?Object(u.jsx)(K,{onReceive:C}):Object(u.jsxs)("div",{className:"app-window",children:[Object(u.jsxs)("div",{className:"sidebar",children:[Object(u.jsx)(B,{chatlist:a,user:v,show:N,setShow:g}),Object(u.jsxs)("header",{children:[Object(u.jsx)("img",{className:"header-avatar",src:v.avatar,alt:"avatar"}),Object(u.jsxs)("div",{className:"header-buttons",children:[Object(u.jsx)("div",{className:"header-btn",children:Object(u.jsx)(G.a,{style:{color:"#919191"}})}),Object(u.jsx)("div",{onClick:function(){g(!0)},className:"header-btn",children:Object(u.jsx)(Y.a,{style:{color:"#919191"}})}),Object(u.jsx)("div",{className:"header-btn",children:Object(u.jsx)(S.a,{style:{color:"#919191"}})})]})]}),Object(u.jsx)("div",{className:"search",children:Object(u.jsxs)("div",{className:"search-input",children:[Object(u.jsx)(y.a,{fontSize:"small",style:{color:"#919191"}}),Object(u.jsx)("input",{type:"search",placeholder:"Pesquisar ou come\xe7ar uma nova conversa"})]})}),Object(u.jsx)("div",{className:"chatlist",children:a.map((function(e,t){return Object(u.jsx)(j,{data:e,active:i.chatId===a[t].chatId,onClick:function(){return h(a[t])}},t)}))})]}),Object(u.jsxs)("div",{className:"contentarea",children:[void 0!==i.chatId&&Object(u.jsx)(P,{user:v,data:i}),void 0==i.chatId&&Object(u.jsx)(b,{})]})]})};r.a.render(Object(u.jsx)(n.a.StrictMode,{children:Object(u.jsx)(q,{})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.f66a8d65.chunk.js.map